<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tutoriales - MDSHP | Centro de Soporte HP</title>
    <meta name="description" content="Centro de tutoriales y recursos de aprendizaje para usuarios de HP.">
    
    <!-- HP Favicon -->
    <link rel="icon" type="image/x-icon" href="imagenes/favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="imagenes/favicon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="imagenes/favicon.png">
    
    <!-- Google Fonts - HP Style -->
    <link href="https://fonts.googleapis.com/css2?family=Forma+DJR+Display:opsz,wght@9..144,300;9..144,400;9..144,500;9..144,600;9..144,700;9..144,800;9..144,900&display=swap" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.css">
    
    <!-- CSS Styles -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/pages.css">
</head>
<body>
    <!-- Header Placeholder -->
    <div id="header-placeholder"></div>

    <!-- Page Header -->
    <section class="tutoriales-header">
        <div class="container">
            <h1>Centro de Tutoriales</h1>
            <p>Recursos de aprendizaje y documentación técnica para el equipo</p>
        </div>
    </section>

    <!-- Search and Filters -->
    <section class="search-filters-section">
        <div class="search-container">
            <div class="search-header">
                <h2>Encuentre el tutorial que necesita</h2>
                <p>Busque por título, categoría o contenido</p>
            </div>
            
            <div class="search-controls">
                <div class="search-wrapper">
                    <i class="bi bi-search search-icon"></i>
                    <input type="text" class="search-input" id="searchInput" placeholder="Buscar tutoriales...">
                </div>
                
                <select class="filter-select" id="categoryFilter">
                    <option value="">Todas las categorías</option>
                    <option value="hardware">Hardware</option>
                    <option value="software">Software</option>
                    <option value="redes">Redes</option>
                    <option value="seguridad">Seguridad</option>
                    <option value="procedimientos">Procedimientos</option>
                </select>
                
                <select class="filter-select" id="typeFilter">
                    <option value="">Todos los tipos</option>
                    <option value="video">Videos</option>
                    <option value="document">Documentos</option>
                </select>
                
                <select class="filter-select" id="sortFilter">
                    <option value="recent">Más recientes</option>
                    <option value="popular">Más populares</option>
                    <option value="title">Por título</option>
                </select>
            </div>
            
            <div class="results-count" id="resultsCount">
                Mostrando 6 tutoriales
            </div>
        </div>
    </section>

    <!-- Tutorials Library -->
    <section class="tutorials-library">
        <div class="container">
            <div class="enhanced-library-header">
                <div class="library-title-section">
                    <h2>Biblioteca de Recursos</h2>
                    <p class="library-subtitle">Contenido educativo y técnico</p>
                </div>
                
                <div class="view-controls">
                    <button class="view-btn active" id="gridViewBtn" title="Vista de cuadrícula">
                        <i class="bi bi-grid-3x3-gap"></i>
                    </button>
                    <button class="view-btn" id="listViewBtn" title="Vista de lista">
                        <i class="bi bi-list"></i>
                    </button>
                </div>
            </div>

            <!-- Grid View -->
            <div class="tutorials-grid-view" id="tutorialsGrid">
                <!-- Video Tutorial -->
                <div class="tutorial-grid-card" data-category="software" data-type="video" data-title="configurar outlook 365">
                    <div class="tutorial-thumbnail video">
                        <i class="bi bi-play-circle thumbnail-icon"></i>
                        <div class="tutorial-duration">5:32</div>
                    </div>
                    <div class="tutorial-grid-content">
                        <h3 class="tutorial-grid-title">Configurar Outlook 365</h3>
                        <p class="tutorial-grid-description">Configuración de cuenta de correo corporativo paso a paso con todas las opciones avanzadas</p>
                        <div class="tutorial-grid-meta">
                            <span class="tutorial-category-badge">Software</span>
                            <div class="tutorial-stats">
                                <span><i class="bi bi-eye"></i> 1,234</span>
                                <span><i class="bi bi-calendar3"></i> 22/07/2025</span>
                            </div>
                        </div>
                        <div class="tutorial-grid-actions">
                            <button class="tutorial-action-btn play-tutorial-btn" data-video="https://www.youtube.com/embed/dQw4w9WgXcQ">
                                <i class="bi bi-play"></i> Ver Tutorial
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Video Tutorial -->
                <div class="tutorial-grid-card" data-category="hardware" data-type="video" data-title="resolución problemas impresora">
                    <div class="tutorial-thumbnail video">
                        <i class="bi bi-play-circle thumbnail-icon"></i>
                        <div class="tutorial-duration">8:45</div>
                    </div>
                    <div class="tutorial-grid-content">
                        <h3 class="tutorial-grid-title">Resolución de Problemas de Impresora</h3>
                        <p class="tutorial-grid-description">Soluciones para problemas comunes de conectividad y configuración de impresoras</p>
                        <div class="tutorial-grid-meta">
                            <span class="tutorial-category-badge">Hardware</span>
                            <div class="tutorial-stats">
                                <span><i class="bi bi-eye"></i> 856</span>
                                <span><i class="bi bi-calendar3"></i> 21/07/2025</span>
                            </div>
                        </div>
                        <div class="tutorial-grid-actions">
                            <button class="tutorial-action-btn play-tutorial-btn" data-video="https://www.youtube.com/embed/dQw4w9WgXcQ">
                                <i class="bi bi-play"></i> Ver Tutorial
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Video Tutorial -->
                <div class="tutorial-grid-card" data-category="redes" data-type="video" data-title="configuración vpn corporativa">
                    <div class="tutorial-thumbnail video">
                        <i class="bi bi-play-circle thumbnail-icon"></i>
                        <div class="tutorial-duration">12:18</div>
                    </div>
                    <div class="tutorial-grid-content">
                        <h3 class="tutorial-grid-title">Configuración de VPN Corporativa</h3>
                        <p class="tutorial-grid-description">Guía completa para conexión VPN desde ubicaciones remotas y solución de problemas</p>
                        <div class="tutorial-grid-meta">
                            <span class="tutorial-category-badge">Redes</span>
                            <div class="tutorial-stats">
                                <span><i class="bi bi-eye"></i> 2,105</span>
                                <span><i class="bi bi-calendar3"></i> 20/07/2025</span>
                            </div>
                        </div>
                        <div class="tutorial-grid-actions">
                            <button class="tutorial-action-btn play-tutorial-btn" data-video="https://www.youtube.com/embed/dQw4w9WgXcQ">
                                <i class="bi bi-play"></i> Ver Tutorial
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Document -->
                <div class="tutorial-grid-card" data-category="seguridad" data-type="document" data-title="manual seguridad digital">
                    <div class="tutorial-thumbnail document">
                        <i class="bi bi-file-earmark-pdf thumbnail-icon"></i>
                    </div>
                    <div class="tutorial-grid-content">
                        <h3 class="tutorial-grid-title">Manual de Seguridad Digital</h3>
                        <p class="tutorial-grid-description">Mejores prácticas de seguridad para usuarios corporativos y protección de datos</p>
                        <div class="tutorial-grid-meta">
                            <span class="tutorial-category-badge">Seguridad</span>
                            <div class="tutorial-stats">
                                <span><i class="bi bi-download"></i> 432</span>
                                <span><i class="bi bi-file-earmark"></i> 2.4 MB</span>
                            </div>
                        </div>
                        <div class="tutorial-grid-actions">
                            <button class="tutorial-action-btn download-tutorial-btn">
                                <i class="bi bi-download"></i> Descargar
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Video Tutorial -->
                <div class="tutorial-grid-card" data-category="software" data-type="video" data-title="microsoft teams reuniones efectivas">
                    <div class="tutorial-thumbnail video">
                        <i class="bi bi-play-circle thumbnail-icon"></i>
                        <div class="tutorial-duration">6:22</div>
                    </div>
                    <div class="tutorial-grid-content">
                        <h3 class="tutorial-grid-title">Microsoft Teams: Reuniones Efectivas</h3>
                        <p class="tutorial-grid-description">Uso avanzado de Teams para reuniones productivas y colaboración en equipo</p>
                        <div class="tutorial-grid-meta">
                            <span class="tutorial-category-badge">Software</span>
                            <div class="tutorial-stats">
                                <span><i class="bi bi-eye"></i> 1,789</span>
                                <span><i class="bi bi-calendar3"></i> 19/07/2025</span>
                            </div>
                        </div>
                        <div class="tutorial-grid-actions">
                            <button class="tutorial-action-btn play-tutorial-btn" data-video="https://www.youtube.com/embed/dQw4w9WgXcQ">
                                <i class="bi bi-play"></i> Ver Tutorial
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Video Tutorial -->
                <div class="tutorial-grid-card" data-category="hardware" data-type="video" data-title="mantenimiento preventivo pc">
                    <div class="tutorial-thumbnail video">
                        <i class="bi bi-play-circle thumbnail-icon"></i>
                        <div class="tutorial-duration">4:15</div>
                    </div>
                    <div class="tutorial-grid-content">
                        <h3 class="tutorial-grid-title">Mantenimiento Preventivo de PC</h3>
                        <p class="tutorial-grid-description">Rutinas de limpieza y mantenimiento para equipos corporativos y prolongar vida útil</p>
                        <div class="tutorial-grid-meta">
                            <span class="tutorial-category-badge">Hardware</span>
                            <div class="tutorial-stats">
                                <span><i class="bi bi-eye"></i> 945</span>
                                <span><i class="bi bi-calendar3"></i> 18/07/2025</span>
                            </div>
                        </div>
                        <div class="tutorial-grid-actions">
                            <button class="tutorial-action-btn play-tutorial-btn" data-video="https://www.youtube.com/embed/dQw4w9WgXcQ">
                                <i class="bi bi-play"></i> Ver Tutorial
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- No Results -->
            <div class="no-results" id="noResults" style="display: none;">
                <div class="no-results-icon">
                    <i class="bi bi-search"></i>
                </div>
                <h3>No se encontraron tutoriales</h3>
                <p>Intente con diferentes términos de búsqueda o filtros</p>
            </div>
        </div>
    </section>

    <!-- Video Modal -->
    <div id="videoModal" class="video-modal">
        <div class="video-modal-content">
            <button class="video-close">&times;</button>
            <iframe id="videoFrame" src="" frameborder="0" allowfullscreen></iframe>
        </div>
    </div>

    <!-- Admin Access -->
    <div class="admin-access">
        <div class="admin-tooltip">Acceso Administrativo</div>
        <button class="admin-access-btn" id="adminAccessBtn">
            <i class="bi bi-gear"></i>
        </button>
    </div>

    <!-- Footer Placeholder -->
    <div id="footer-placeholder"></div>

    <!-- Components Loader -->
    <script src="js/components.js"></script>
    <script src="js/main.js"></script>
    <script>
        // Variables globales
        let currentView = 'grid';
        let allTutorials = [];

        // Inicializar la página
        document.addEventListener('DOMContentLoaded', function() {
            initializeTutorials();
            initializeSearch();
            initializeViewToggle();
            initializeVideoModal();
            initializeAdminAccess();
        });

        // Inicializar acceso administrativo
        function initializeAdminAccess() {
            const adminAccessBtn = document.getElementById('adminAccessBtn');
            
            adminAccessBtn.addEventListener('click', function() {
                // Verificar si existe una sesión administrativa activa
                const session = localStorage.getItem('mdshp_admin_session');
                
                if (session) {
                    try {
                        const sessionData = JSON.parse(session);
                        const now = new Date().toISOString();
                        
                        if (sessionData.expiresAt > now) {
                            // Sesión válida, ir directamente al panel
                            window.location.href = 'admin/panel.html';
                            return;
                        } else {
                            // Sesión expirada, limpiar
                            localStorage.removeItem('mdshp_admin_session');
                        }
                    } catch (e) {
                        // Sesión corrupta, limpiar
                        localStorage.removeItem('mdshp_admin_session');
                    }
                }
                
                // No hay sesión válida, ir al login
                window.location.href = 'admin/login.html';
            });
        }

        // Inicializar tutoriales
        function initializeTutorials() {
            allTutorials = Array.from(document.querySelectorAll('.tutorial-grid-card')).map(card => ({
                element: card,
                listElement: document.querySelector(`.tutorial-item[data-title="${card.dataset.title}"]`),
                category: card.dataset.category,
                type: card.dataset.type,
                title: card.dataset.title,
                text: card.textContent.toLowerCase()
            }));
            
            updateResultsCount();
        }

        // Inicializar búsqueda y filtros
        function initializeSearch() {
            const searchInput = document.getElementById('searchInput');
            const categoryFilter = document.getElementById('categoryFilter');
            const typeFilter = document.getElementById('typeFilter');
            const sortFilter = document.getElementById('sortFilter');

            // Event listeners
            searchInput.addEventListener('input', debounce(performSearch, 300));
            categoryFilter.addEventListener('change', performSearch);
            typeFilter.addEventListener('change', performSearch);
            sortFilter.addEventListener('change', performSearch);
        }

        // Realizar búsqueda
        function performSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;
            const typeFilter = document.getElementById('typeFilter').value;
            const sortFilter = document.getElementById('sortFilter').value;

            let filteredTutorials = allTutorials.filter(tutorial => {
                const matchesSearch = !searchTerm || tutorial.text.includes(searchTerm);
                const matchesCategory = !categoryFilter || tutorial.category === categoryFilter;
                const matchesType = !typeFilter || tutorial.type === typeFilter;
                
                return matchesSearch && matchesCategory && matchesType;
            });

            // Aplicar ordenamiento
            filteredTutorials = sortTutorials(filteredTutorials, sortFilter);

            // Mostrar/ocultar tutoriales
            allTutorials.forEach(tutorial => {
                const isVisible = filteredTutorials.includes(tutorial);
                tutorial.element.style.display = isVisible ? 'block' : 'none';
                if (tutorial.listElement) {
                    tutorial.listElement.style.display = isVisible ? 'flex' : 'none';
                }
            });

            // Actualizar contador y mostrar mensaje si no hay resultados
            updateResultsCount(filteredTutorials.length);
            document.getElementById('noResults').style.display = 
                filteredTutorials.length === 0 ? 'block' : 'none';
        }

        // Ordenar tutoriales
        function sortTutorials(tutorials, sortBy) {
            return tutorials.sort((a, b) => {
                switch (sortBy) {
                    case 'title':
                        return a.title.localeCompare(b.title);
                    case 'popular':
                        // Simular popularidad basada en el orden actual
                        return Math.random() - 0.5;
                    case 'recent':
                    default:
                        // Mantener orden actual (más recientes primero)
                        return 0;
                }
            });
        }

        // Actualizar contador de resultados
        function updateResultsCount(count = null) {
            const totalCount = count !== null ? count : allTutorials.length;
            const resultsCount = document.getElementById('resultsCount');
            
            if (totalCount === 0) {
                resultsCount.textContent = 'No se encontraron tutoriales';
            } else if (totalCount === 1) {
                resultsCount.textContent = 'Mostrando 1 tutorial';
            } else {
                resultsCount.textContent = `Mostrando ${totalCount} tutoriales`;
            }
        }

        // Inicializar toggle de vista
        function initializeViewToggle() {
            const gridViewBtn = document.getElementById('gridViewBtn');
            const listViewBtn = document.getElementById('listViewBtn');
            const tutorialsGrid = document.getElementById('tutorialsGrid');
            const tutorialsList = document.getElementById('tutorialsList');

            gridViewBtn.addEventListener('click', function() {
                if (currentView !== 'grid') {
                    currentView = 'grid';
                    this.classList.add('active');
                    listViewBtn.classList.remove('active');
                    tutorialsGrid.classList.remove('hidden');
                    if (tutorialsList) tutorialsList.classList.add('hidden');
                }
            });

            listViewBtn.addEventListener('click', function() {
                if (currentView !== 'list') {
                    currentView = 'list';
                    this.classList.add('active');
                    gridViewBtn.classList.remove('active');
                    if (tutorialsList) tutorialsList.classList.remove('hidden');
                    tutorialsGrid.classList.add('hidden');
                }
            });
        }

        // Inicializar modal de video
        function initializeVideoModal() {
            const videoModal = document.getElementById('videoModal');
            const videoFrame = document.getElementById('videoFrame');
            const closeBtn = document.querySelector('.video-close');

            // Event delegation for video buttons
            document.addEventListener('click', function(e) {
                if (e.target.closest('.play-tutorial-btn, .play-btn')) {
                    const button = e.target.closest('.play-tutorial-btn, .play-btn');
                    const videoUrl = button.dataset.video;
                    if (videoUrl) {
                        videoFrame.src = videoUrl;
                        videoModal.style.display = 'flex';
                        document.body.style.overflow = 'hidden';
                    }
                }
            });

            // Cerrar modal
            closeBtn.addEventListener('click', closeModal);
            videoModal.addEventListener('click', function(e) {
                if (e.target === videoModal) {
                    closeModal();
                }
            });

            // Cerrar con ESC
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && videoModal.style.display === 'flex') {
                    closeModal();
                }
            });

            function closeModal() {
                videoModal.style.display = 'none';
                videoFrame.src = '';
                document.body.style.overflow = 'auto';
            }
        }

        // Utility: Debounce function
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Manejar descargas
        document.addEventListener('click', function(e) {
            if (e.target.closest('.download-tutorial-btn, .download-btn')) {
                e.preventDefault();
                alert('Descarga iniciada. El archivo se guardará en su carpeta de descargas.');
            }
        });
    </script>
</body>
</html>